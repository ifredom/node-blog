#!/usr/bin/env node
// 使用es6语法
// babel-register模块改写require命令，为它加上一个钩子。此后，每当使用require加载.js、.jsx、.es和.es6后缀名的文件，就会先用Babel进行转码。
// 由于它是实时转码，所以只适合在开发环境使用，并且当前加载文件无法使用。
require('babel-core/register');
var http = require('http');
var app = require('../app.js');
var config = require('../config');
var server = http.createServer(app);

server.on('error', onError);
server.on('listening', onListening);
server.listen(config.port);

function onError(error) {
    if (error.syscall !== 'listen') {
        throw error;
    }

    switch (error.code) {
        case 'EACCES':
            console.log(`${config.port} requires elevated privileges.\n`);
            process.exit(1);
            break;
        case 'EADDRINUSE':
            console.log(`${config.port} is already in use.change other.\n`);
            process.exit(1);
            break;
        default:
            throw error;
    }
}
function onListening() {
    var addr = server.address();
    console.log(`Your application is running here: http://localhost:${addr.port}\n`);
}
