# 图片的隐藏密码

图片的隐藏密码

## 项目介绍

>为了方便起见，将代码直接写在html中方便查阅。
encode.html，介绍了是如何将数据信息藏在一张图片中
decode.html，介绍了是如何从一张拥有隐藏信息的图片中，把数据给解读出来.

---

图像基本上是2D像素阵列。每个像素都是是3个字节的元组，每个颜色分量一个RGB - RGB。每个颜色分量的范围都是0到255.这有助于自然地存储字节/字符数组。例如，单个像素可用于存储ASCII字符数组['F'，'T'，'W']，将其ASCII码编码为颜色强度，类似这样的一个...


[123, 34, 97, 255, 117, 116, 104, 255, 111, 114, 34, 255, 58, 34, 105, 255, 102, 114, 101, 255, 100, 111, 109, 255, 34, 44, 34, 255, 100, 97, 116, 255, 97, 34, 58, 255, 91, 34, 50, 255, 48, 49, 56, 255, 57, 45, 48, 255, 49, 45, 48, 255, 52, 34...]

---

虽然存储和生成1像素的图像是最容易实现的，但要有足够空间保存我的数据并点击下载下来并不容易，所以我不得不使用足够大小的方形图像。因此，图像的预设最大尺寸（256 x 256像素）可以很好地实现此目的，但它需要跟踪实际编码数据的大小。此编码大小是正方形的长度，必须存储在生成的图像中。使用第一个像素的单一颜色可以让我有一个最大255 x 255的正方形 - 第一行被没收来存储这个大小值，因为它是一个正方形，图像中的最后一列也被没收了。要编码的字节/字符数组的大小也必须以某种方式保留，

---

由于可用像素数据的最大尺寸为255 x 255像素，因此我可以使用65025像素。反过来，这转换为195075字节（190kB）的文本数据。这远远高于我实际需要的水平。
使用TextEncoder我可以将序列化的JSON数据转换为字节数组（JavaScript中的Uint8Array）。
使用离屏画布可以让我随意操作像素数据，然后转换为我想要的格式的图像数据URL。



## 特性/适用场景

需要提供保存/加载功能的web程序，不依赖于cookie，本地存储或服务器端存储（没有帐户或登录之类的前后端交互）

## 图片的要求

1. 生成的图像必须易于保存，并且应具有预设尺寸。
2. 我正在处理的保存/加载数据大约是几十千字节。
3. 数据存储为JSON格式
4. 我不想处理任何特定图像格式的保存/加载细节。


### 期间遇到的困难

1. Mobile Safari忽略link元素中的download属性。这导致序列化的JSON数据只能显示在浏览器窗口中，而无法将其存储在用户的设备上。而且还没有办法禁用它。

2. 直接打开html文件，`getImageData`方法无法获取到图片的数据，会遇到跨域（google即将变成ie了...）,需要本地开启一个服务器才可以运行。  [我在segmentfault上的回答](https://segmentfault.com/q/1010000005106685)

3. 我尝试过使用QR二维码来保存数据，二维码非常容易生成，但解码方面并不那么简单，需要引入体积相当大的库，所以我很快就放弃了使用它。